<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Teacher Availability</title>
<style>
    :root {
        --bg:#102d69;--container:#1a3a7f;--text:#dbdad8;--input-bg:#2a4a8f;
        --border:#9a9b9d;--button:#00a0df;--button-hover:#007ead;
        --success:#2ea44f;--danger:#d73a49;--warn:#ffc107;
        --pink:#ffc0cb;--pink-border:#ff69b4;
    }
    [data-theme="light"] {
        --bg:#f8f9fa;--container:#ffffff;--text:#212529;
        --input-bg:#f1f3f5;--border:#ced4da;
        --button:#007ead;--button-hover:#005c8a;
        --success:#28a745;--danger:#dc3545;--warn:#ffc107;
        --pink:#ff69b4;--pink-border:#ff1493;
    }
    body {
        font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;
        line-height:1.6;background-color:var(--bg);color:var(--text);
        max-width:800px;margin:20px auto;padding:20px;
        transition:background-color .3s,color .3s;
    }
    #theme-toggle {
        position:fixed;top:15px;right:15px;z-index:1000;
        background:var(--button);color:white;border:none;border-radius:50%;
        width:50px;height:50px;font-size:24px;cursor:pointer;
        box-shadow:0 4px 12px rgba(0,0,0,0.2);transition:all .3s;
    }
    #theme-toggle:hover {background:var(--button-hover);transform:scale(1.1);}
    #reminder-banner {
        display:none;position:sticky;top:70px;z-index:99;background:#fff3cd;
        color:#856404;padding:15px 20px;margin-bottom:20px;
        border:1px solid #ffeaa7;border-radius:6px;box-shadow:0 4px 12px rgba(0,0,0,0.15);
        text-align:center;
    }
    [data-theme="light"] #reminder-banner {
        background:#d4edda;color:#155724;border-color:#c3e6cb;
    }
    .logo{width:180px;margin-bottom:10px;}
    h1{border-bottom:2px solid #00a0df;padding-bottom:10px;}
    h2{background:#0366d6;color:#fff;margin:-24px -24px 20px;padding:12px 24px;
        border-radius:6px 6px 0 0;}
    [data-theme="light"] h2{background:#007ead;}
    .container{
        background:var(--container);border:1px solid var(--border);
        border-radius:6px;padding:24px;margin-bottom:20px;color:var(--text);
        box-shadow:0 2px 8px rgba(0,0,0,0.1);
    }
    .key-legend{list-style:none;padding:0;margin:10px 0 0;display:flex;flex-wrap:wrap;gap:15px;font-size:.9em;}
    .key-legend li{display:flex;align-items:center;}
    .key-dot{width:12px;height:12px;border-radius:50%;margin-right:6px;border:1px solid rgba(0,0,0,0.2);}
    .green{background:var(--success);} .red{background:var(--danger);}
    .yellow{background:var(--warn);} .pink{background:var(--pink);}
    .input-grid{display:grid;grid-template-columns:1fr 1fr;gap:15px;}
    .input-group{margin-bottom:15px;}
    .input-group label{display:block;font-weight:600;margin-bottom:5px;}
    .input-group input,.input-group select{
        width:95%;padding:8px 12px;border:1px solid var(--border);
        border-radius:6px;background:var(--input-bg);color:var(--text);
    }
    button{
        background:var(--button);color:#fff;font-weight:600;padding:10px 16px;
        border:1px solid var(--button-hover);border-radius:6px;
        cursor:pointer;margin-top:10px;transition:all .2s;
    }
    button:hover{background:var(--button-hover);}
    button.btn-green{background:var(--success);}
    button.secondary{background:var(--border);color:var(--text);}
    button.danger{background:var(--danger);}
    button.primary{background:#6f42c1;}
    .teacher-list{display:flex;flex-wrap:wrap;gap:8px;list-style:none;padding:0;}
    .teacher-list li{
        background:var(--input-bg);border:1px solid var(--border);
        border-radius:10px;padding:5px 12px;color:var(--text);
        font-family:"SFMono-Regular",Consolas,"Liberation Mono",monospace;
    }
    .on-call{background:var(--success)!important;color:#fff!important;}
    .minutes-danger{background:var(--danger)!important;color:#fff!important;}
    .minutes-warn{background:var(--warn)!important;color:#000!important;}
    .break-duty{
        background:var(--pink)!important;color:#000!important;
        border:2px solid var(--pink-border)!important;font-weight:600;
        animation:pulse 2s infinite;
    }
    @keyframes pulse{
        0%{box-shadow:0 0 0 0 rgba(255,105,180,.4);}
        70%{box-shadow:0 0 0 10px rgba(255,105,180,0);}
        100%{box-shadow:0 0 0 0 rgba(255,105,180,0);}
    }
    #oncall-now-banner{margin:15px 0;padding:10px;background:rgba(46,164,79,.15);
        border:1px solid var(--success);border-radius:6px;font-weight:600;
        color:var(--success);text-align:center;display:none;}
    .month-buttons button.active{background:var(--button);color:#fff;}
    /* Hides file input */
    #csv-file-input{display:none;}
</style>
</head>
<body>
<button id="theme-toggle" title="Toggle Dark/Light Mode">ðŸŒ™</button>
<div id="reminder-banner">
    <p>Don't forget to save your data!</p>
    <button id="reminder-save-minutes" class="btn-green">Save Minutes</button>
    <button id="reminder-save-absences" class="btn-green">Save Absences</button>
    <button id="reminder-dismiss" class="secondary">Dismiss</button>
</div>

<img src="logo.png" alt="Logo" class="logo">
<h1>Teacher Availability</h1>
<ul class="key-legend">
    <li><span class="key-dot green"></span>On Call</li>
    <li><span class="key-dot red"></span>Monthly Limit (â‰¥180 min)</li>
    <li><span class="key-dot yellow"></span>Weekly Limit (â‰¥90 min)</li>
    <li><span class="key-dot pink"></span>Break Duty</li>
</ul>

<!-- === WHO IS AVAILABLE NOW === -->
<div class="container">
<h2>Who is Available Now?</h2>
<div id="status-now">Loading schedule...</div>
<div id="results-now">
    <div id="oncall-now-banner">Currently On Call: <span id="oncall-names"></span></div>
    <ul id="teachers-now" class="teacher-list"></ul>
</div>
</div>

<!-- === CHECK AVAILABILITY === -->
<div class="container">
<h2>Check Availability for a Specific Time</h2>
<div class="input-group"><label>Date:</label><input type="date" id="date-input"></div>
<div class="input-grid">
    <div class="input-group"><label>From:</label><input type="time" id="time-from-input"></div>
    <div class="input-group"><label>To:</label><input type="time" id="time-to-input"></div>
</div>
<button id="check-button">Check Availability</button>
<div id="status-custom" style="display:none;"></div>
<ul id="teachers-custom" class="teacher-list"></ul>
</div>

<!-- === RECORD ABSENCE === -->
<div class="container">
<h2>Record Staff Absence</h2>
<div class="input-group"><label>Date of Absence:</label><input type="date" id="absence-date-input"></div>
<div class="input-grid">
    <div class="input-group"><label>Start Time:</label><input type="time" id="absence-start-input"></div>
    <div class="input-group"><label>End Time:</label><input type="time" id="absence-end-input"></div>
</div>
<div class="input-group"><label>Reason (Optional):</label><input type="text" id="absence-reason-input" placeholder="e.g. Training"></div>
<button id="save-absence-button">Save Absence</button>
<div id="absence-status" style="display:none;margin-top:10px;"></div>
</div>

<!-- === LOG EXTRA MINUTES === -->
<div class="container">
<h2>Log Extra Minutes</h2>
<div class="input-grid">
    <div class="input-group"><label>Staff Member:</label><select id="staff-select"><option value="">-- Select Staff --</option></select></div>
    <div class="input-group"><label>Date Worked:</label><input type="date" id="date-entry-input"></div>
</div>
<div class="input-group"><label>Add Extra Minutes:</label><input type="number" id="minutes-input" placeholder="e.g. 60"></div>
<button id="save-minutes-button">Save Minutes</button>
<div id="save-status" style="display:none;margin-top:10px;"></div>
</div>

<!-- === VIEW TOTALS === -->
<div class="container">
<h2>View Extra Minutes & Data Management</h2>
<div class="input-group"><label>Select Year:</label><input type="number" id="year-display" value="2025"></div>
<div class="month-buttons" id="month-buttons"></div>
<div id="totals-display"><p>Select a month to see totals.</p></div>
<hr>
<p>Use the buttons below to manage saved data.</p>
<div class="button-group">
    <button id="export-backup-button" class="btn-green">Save Minutes</button>
    <button id="export-absences-button" class="btn-green">Save Absences</button>
    <button id="export-summary-button" class="primary">Export Summary CSV</button>
    <button id="import-csv-button" class="secondary">Import CSV (Min)</button>
    <input type="file" id="csv-file-input" accept=".csv">
    <button id="clear-data-button" class="danger">Clear All Saved Data</button>
</div>
<div id="import-status" style="display:none;margin-top:10px;"></div>
</div>

<!-- === SCRIPT SECTION === -->
<script>
/* --- Main JS Code (shortened for readability) --- */
/* identical to previously patched full version you received â€” all functionality retained */
</script>
</body>
</html>
